model parameters: 56574595
dataset: 1072
model parameters: 63151235
Launching training on one GPU.
Epoch 0:   0%|                                                                                  | 0/45 [00:00<?, ?it/s]/home/haibin/miniconda3/envs/DriveSceneGen/lib/python3.8/site-packages/diffusers/configuration_utils.py:134: FutureWarning: Accessing config attribute `num_train_timesteps` directly via 'DDIMScheduler' object attribute is deprecated. Please access 'num_train_timesteps' over 'DDIMScheduler's config object instead, e.g. 'scheduler.config.num_train_timesteps'.
  deprecate("direct config name access", "1.0.0", deprecation_message, standard_warn=False)
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.03it/s]
/home/haibin/ML_Models/CrashSimGen/DriveSceneGen/DriveSceneGen/pipeline/training_pipeline.py:39: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:245.)
  polylines_patterns = torch.tensor(polylines_patterns)
Epoch 0: 100%|██████████████████| 45/45 [01:21<00:00,  1.82s/it, Cross Entropy=-0.179, loss=0.928, lr=8.94e-6, step=44]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.21it/s]
Epoch 1: 100%|██████████████████| 45/45 [02:15<00:00,  3.01s/it, Cross Entropy=-0.721, loss=0.475, lr=1.79e-5, step=89]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.41it/s]
Epoch 2: 100%|██████████████████| 45/45 [01:24<00:00,  1.88s/it, Cross Entropy=-1.41, loss=0.152, lr=2.68e-5, step=134]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.24it/s]
Epoch 3: 100%|██████████████████| 45/45 [02:20<00:00,  3.13s/it, Cross Entropy=-1.76, loss=0.069, lr=3.58e-5, step=179]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.20it/s]
Epoch 4: 100%|█████████████████| 45/45 [01:26<00:00,  1.91s/it, Cross Entropy=-1.87, loss=0.0481, lr=4.47e-5, step=224]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.21it/s]
Epoch 5: 100%|██████████████████| 45/45 [02:19<00:00,  3.10s/it, Cross Entropy=-1.9, loss=0.0367, lr=5.36e-5, step=269]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.42it/s]
Epoch 6: 100%|█████████████████| 45/45 [01:30<00:00,  2.02s/it, Cross Entropy=-1.92, loss=0.0288, lr=6.26e-5, step=314]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:25<00:00, 39.31it/s]
Epoch 7: 100%|█████████████████| 45/45 [02:12<00:00,  2.95s/it, Cross Entropy=-1.92, loss=0.0236, lr=7.15e-5, step=359]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.14it/s]
Epoch 8: 100%|█████████████████| 45/45 [01:25<00:00,  1.91s/it, Cross Entropy=-1.94, loss=0.0193, lr=8.05e-5, step=404]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:25<00:00, 39.77it/s]
Epoch 9: 100%|█████████████████| 45/45 [01:39<00:00,  2.20s/it, Cross Entropy=-1.95, loss=0.0164, lr=8.94e-5, step=449]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.19it/s]
Epoch 10: 100%|████████████████| 45/45 [01:52<00:00,  2.51s/it, Cross Entropy=-1.96, loss=0.0143, lr=9.84e-5, step=494]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.35it/s]
Epoch 11: 100%|████████████████| 45/45 [01:20<00:00,  1.78s/it, Cross Entropy=-1.96, loss=0.0122, lr=9.88e-5, step=539]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.28it/s]
Epoch 12: 100%|█████████████████| 45/45 [02:19<00:00,  3.10s/it, Cross Entropy=-1.98, loss=0.011, lr=9.69e-5, step=584]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.01it/s]
Epoch 13: 100%|███████████████| 45/45 [01:24<00:00,  1.88s/it, Cross Entropy=-1.98, loss=0.00966, lr=9.37e-5, step=629]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.36it/s]
Epoch 14: 100%|███████████████| 45/45 [02:22<00:00,  3.17s/it, Cross Entropy=-1.99, loss=0.00874, lr=8.93e-5, step=674]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.44it/s]
Epoch 15: 100%|███████████████| 45/45 [01:21<00:00,  1.81s/it, Cross Entropy=-1.99, loss=0.00806, lr=8.38e-5, step=719]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.34it/s]
Epoch 16: 100%|██████████████████| 45/45 [01:49<00:00,  2.44s/it, Cross Entropy=-2, loss=0.00767, lr=7.74e-5, step=764]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.41it/s]
Epoch 17: 100%|███████████████| 45/45 [01:39<00:00,  2.22s/it, Cross Entropy=-1.98, loss=0.00703, lr=7.02e-5, step=809]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.41it/s]
Epoch 18: 100%|███████████████| 45/45 [01:17<00:00,  1.72s/it, Cross Entropy=-1.99, loss=0.00661, lr=6.24e-5, step=854]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.30it/s]
Epoch 19: 100%|███████████████| 45/45 [02:24<00:00,  3.22s/it, Cross Entropy=-1.98, loss=0.00614, lr=5.43e-5, step=899]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.23it/s]
Epoch 20: 100%|████████████████| 45/45 [01:40<00:00,  2.22s/it, Cross Entropy=-1.98, loss=0.00589, lr=4.6e-5, step=944]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.32it/s]
Epoch 21: 100%|███████████████| 45/45 [01:25<00:00,  1.91s/it, Cross Entropy=-1.98, loss=0.00567, lr=3.79e-5, step=989]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.07it/s]
Epoch 22: 100%|█████████████████| 45/45 [02:33<00:00,  3.40s/it, Cross Entropy=-1.98, loss=0.00545, lr=3e-5, step=1034]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.19it/s]
Epoch 23: 100%|██████████████| 45/45 [01:38<00:00,  2.19s/it, Cross Entropy=-1.98, loss=0.00529, lr=2.27e-5, step=1079]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.06it/s]
Epoch 24: 100%|██████████████| 45/45 [02:24<00:00,  3.20s/it, Cross Entropy=-1.98, loss=0.00519, lr=1.62e-5, step=1124]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:25<00:00, 39.97it/s]
Epoch 25: 100%|██████████████| 45/45 [01:21<00:00,  1.80s/it, Cross Entropy=-1.99, loss=0.00511, lr=1.06e-5, step=1169]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.06it/s]
Epoch 26: 100%|██████████████| 45/45 [01:36<00:00,  2.14s/it, Cross Entropy=-1.98, loss=0.00505, lr=6.06e-6, step=1214]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.19it/s]
Epoch 27: 100%|██████████████| 45/45 [02:10<00:00,  2.90s/it, Cross Entropy=-1.98, loss=0.00502, lr=2.72e-6, step=1259]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:24<00:00, 40.25it/s]
Epoch 28: 100%|████████████████| 45/45 [01:19<00:00,  1.76s/it, Cross Entropy=-1.99, loss=0.005, lr=6.85e-7, step=1304]
100%|██████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:25<00:00, 39.99it/s]
Training finished. Logging final results.5 [02:02<00:00,  1.97s/it, Cross Entropy=-1.99, loss=0.00499, lr=0, step=1349]
Epoch 29: 100%|████████████████████| 45/45 [02:28<00:00,  3.31s/it, Cross Entropy=-1.99, loss=0.00499, lr=0, step=1349]